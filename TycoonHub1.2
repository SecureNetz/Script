-- // Tycoon Hub 1.1 (Official Version)
-- // Integrated with Horror Tycoon Gear Collector & Taunt Tool

-- // Configuration for Taunt Tool
getgenv().JERK_OFF_SPEED = 50
getgenv().KEEP_ON_DEATH = true

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")
local LocalPlayer = Players.LocalPlayer

-- // Tycoon Settings
getgenv().AutoCollect = false
getgenv().AutoBuy = false
getgenv().Noclip = false
getgenv().AuraRange = 50
local buyCooldown = false 
local lastIndex = 0
local minimized = false

-- // Animation Settings
local MAIN_ANIMATIONS = {
    JERK_OFF = "rbxassetid://99198989",
    CLOSER_HANDS = "rbxassetid://168086975",
}
local FADE_IN_TIME = 0.8  
local FADE_OUT_TIME = 0.8 
local JerkingOff = false
local jerkoffTrack, closerhandsTrack

-- // Taunt Tool Logic
local function StopAnimations()
    if jerkoffTrack then jerkoffTrack:Stop(FADE_OUT_TIME) jerkoffTrack = nil end
    if closerhandsTrack then closerhandsTrack:Stop(FADE_OUT_TIME) closerhandsTrack = nil end
end

local function GiveTool()
    if LocalPlayer.Backpack:FindFirstChild("Taunt ðŸ˜³") then return end
    local Tool = Instance.new("Tool")
    Tool.Name = "Taunt ðŸ˜³"
    Tool.RequiresHandle = false
    Tool.Equipped:Connect(function() JerkingOff = true end)
    Tool.Unequipped:Connect(function() JerkingOff = false StopAnimations() end)
    Tool.Parent = LocalPlayer:WaitForChild("Backpack")
end

-- // Horror Tycoon Logic
local targetGears = {"GEAR1", "GEAR2", "GEAR3", "GEAR4", "GEAR5", "GEAR6", "GEAR7", "GEAR8", "GEAR9", "GEAR10"}

local function collectSpecificGears()
    local char = LocalPlayer.Character
    local root = char and char:FindFirstChild("HumanoidRootPart")
    if not root then return end
    
    local originalLocation = root.CFrame
    local foundAny = false

    for _, obj in ipairs(game:GetService("Workspace"):GetDescendants()) do
        for _, gearName in ipairs(targetGears) do
            if obj.Name == gearName then
                local touchPart = obj:FindFirstChild("Handle") or (obj:IsA("BasePart") and obj)
                if touchPart then
                    foundAny = true
                    root.CFrame = touchPart.CFrame
                    task.wait(0.15) 
                end
            end
        end
    end
    root.CFrame = originalLocation
    
    game:GetService("StarterGui"):SetCore("SendNotification", {
        Title = "Tycoon Hub 1.1",
        Text = foundAny and "Gears Collected!" or "No Gears Found.",
        Duration = 3
    })
end

-- // Index Cycling Teleport
local function GetAllBases()
    local bases = {}
    for _, v in pairs(workspace:GetDescendants()) do
        if v:IsA("TextLabel") and (v.Text:find("Owner") or v.Text:find("Nobody") or v.Text:lower():find("open")) then
            local basePart = v:FindFirstAncestorWhichIsA("BasePart") or v.Parent:FindFirstChildOfClass("BasePart")
            if basePart then table.insert(bases, basePart) end
        end
    end
    return bases
end

local function TeleportToOpenBase()
    local char = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
    local root = char:WaitForChild("HumanoidRootPart")
    local allBases = GetAllBases()
    if #allBases == 0 then return false end
    lastIndex = (lastIndex % #allBases) + 1
    local target = allBases[lastIndex]
    if target then
        root.Velocity = Vector3.new(0,0,0)
        root.CFrame = target.CFrame * CFrame.new(0, 3, 10)
        return true
    end
    return false
end

-- // GUI Setup (Tycoon Hub 1.1)
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "TycoonHub1.1"
ScreenGui.Parent = LocalPlayer:WaitForChild("PlayerGui")
ScreenGui.ResetOnSpawn = false

local MainFrame = Instance.new("Frame")
MainFrame.Size = UDim2.new(0, 250, 0, 430) 
MainFrame.Position = UDim2.new(0.5, -125, 0.5, -215)
MainFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
MainFrame.BorderSizePixel = 0
MainFrame.Active = true
MainFrame.Draggable = true 
MainFrame.Parent = ScreenGui
Instance.new("UICorner", MainFrame)

local Title = Instance.new("TextLabel")
Title.Size = UDim2.new(1, 0, 0, 45)
Title.Text = "TYCOON HUB 1.1"
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
Title.Font = Enum.Font.GothamBold
Title.TextSize = 14
Title.Parent = MainFrame
Instance.new("UICorner", Title)

local Status = Instance.new("TextLabel")
Status.Size = UDim2.new(1, 0, 0, 20)
Status.Position = UDim2.new(0, 0, 1, -25)
Status.Text = "Status: Ready"
Status.TextColor3 = Color3.fromRGB(150, 150, 150)
Status.BackgroundTransparency = 1
Status.Font = Enum.Font.Gotham
Status.TextSize = 10
Status.Parent = MainFrame

local MinBtn = Instance.new("TextButton")
MinBtn.Size = UDim2.new(0, 30, 0, 30)
MinBtn.Position = UDim2.new(1, -35, 0, 7)
MinBtn.Text = "-"
MinBtn.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
MinBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
MinBtn.Font = Enum.Font.GothamBold
MinBtn.Parent = MainFrame
Instance.new("UICorner", MinBtn)

local buttons = {}
local function CreateButton(text, pos, callback)
    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(0.85, 0, 0, 38)
    btn.Position = pos
    btn.Text = text
    btn.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    btn.TextColor3 = Color3.fromRGB(255, 255, 255)
    btn.Font = Enum.Font.GothamSemibold
    btn.TextSize = 13
    btn.Parent = MainFrame
    Instance.new("UICorner", btn)
    table.insert(buttons, btn)
    btn.MouseButton1Click:Connect(function() callback(btn) end)
    return btn
end

-- // Features
CreateButton("Auto-Collect: OFF", UDim2.new(0.075, 0, 0.12, 0), function(btn)
    getgenv().AutoCollect = not getgenv().AutoCollect
    btn.Text = getgenv().AutoCollect and "Auto-Collect: ON" or "Auto-Collect: OFF"
    btn.BackgroundColor3 = getgenv().AutoCollect and Color3.fromRGB(60, 160, 60) or Color3.fromRGB(50, 50, 50)
end)

CreateButton("Auto-Buy: OFF", UDim2.new(0.075, 0, 0.22, 0), function(btn)
    getgenv().AutoBuy = not getgenv().AutoBuy
    btn.Text = getgenv().AutoBuy and "Auto-Buy: ON" or "Auto-Buy: OFF"
    btn.BackgroundColor3 = getgenv().AutoBuy and Color3.fromRGB(60, 160, 60) or Color3.fromRGB(50, 50, 50)
end)

CreateButton("Noclip: OFF", UDim2.new(0.075, 0, 0.32, 0), function(btn)
    getgenv().Noclip = not getgenv().Noclip
    btn.Text = getgenv().Noclip and "Noclip: ON" or "Noclip: OFF"
    btn.BackgroundColor3 = getgenv().Noclip and Color3.fromRGB(160, 60, 60) or Color3.fromRGB(50, 50, 50)
end)

CreateButton("Cycle Through Bases", UDim2.new(0.075, 0, 0.42, 0), function(btn)
    local success = TeleportToOpenBase()
    btn.Text = success and "Teleported!" or "No Bases Found"
    task.wait(0.5)
    btn.Text = "Cycle Through Bases"
end)

CreateButton("Collect Horror Gears", UDim2.new(0.075, 0, 0.52, 0), function(btn)
    btn.Text = "Scanning..."
    collectSpecificGears()
    task.wait(0.5)
    btn.Text = "Collect Horror Gears"
end)

local RangeDisplay = Instance.new("TextLabel")
RangeDisplay.Size = UDim2.new(1, 0, 0, 30)
RangeDisplay.Position = UDim2.new(0, 0, 0.64, 0)
RangeDisplay.Text = "Aura Range: 50"
RangeDisplay.TextColor3 = Color3.fromRGB(255, 255, 255)
RangeDisplay.BackgroundTransparency = 1
RangeDisplay.Font = Enum.Font.GothamBold
RangeDisplay.Parent = MainFrame

local minusBtn = CreateButton("- Range", UDim2.new(0.075, 0, 0.74, 0), function()
    getgenv().AuraRange = math.max(10, getgenv().AuraRange - 5)
    RangeDisplay.Text = "Aura Range: " .. getgenv().AuraRange
end)
minusBtn.Size = UDim2.new(0.4, 0, 0, 40)

local plusBtn = CreateButton("+ Range", UDim2.new(0.525, 0, 0.74, 0), function()
    getgenv().AuraRange = math.min(100, getgenv().AuraRange + 5)
    RangeDisplay.Text = "Aura Range: " .. getgenv().AuraRange
end)
plusBtn.Size = UDim2.new(0.4, 0, 0, 40)

-- // Heartbeat Loop & Logic Integration
LocalPlayer.CharacterAdded:Connect(function()
    StopAnimations()
    if getgenv().KEEP_ON_DEATH then GiveTool() end
end)
if getgenv().KEEP_ON_DEATH then GiveTool() end

RunService.Heartbeat:Connect(function()
    local char = LocalPlayer.Character
    local root = char and char:FindFirstChild("HumanoidRootPart")
    local Animator = char and char:FindFirstChildOfClass("Humanoid") and char.Humanoid:FindFirstChildOfClass("Animator")

    if not root or not Animator then return end

    -- Taunt Animation Logic
    if JerkingOff then
        if not jerkoffTrack then
            local a1 = Instance.new("Animation")
            a1.AnimationId = MAIN_ANIMATIONS.JERK_OFF
            jerkoffTrack = Animator:LoadAnimation(a1)
            jerkoffTrack.Priority = Enum.AnimationPriority.Action
            jerkoffTrack.Looped = true
            jerkoffTrack:Play(FADE_IN_TIME)
        end
        if not closerhandsTrack then
            local a2 = Instance.new("Animation")
            a2.AnimationId = MAIN_ANIMATIONS.CLOSER_HANDS
            closerhandsTrack = Animator:LoadAnimation(a2)
            closerhandsTrack.Priority = Enum.AnimationPriority.Action
            closerhandsTrack:Play(FADE_IN_TIME)
        end
        if jerkoffTrack then jerkoffTrack:AdjustSpeed(getgenv().JERK_OFF_SPEED) end
        if closerhandsTrack then closerhandsTrack:AdjustSpeed(getgenv().JERK_OFF_SPEED) end
    end

    -- Tycoon Hub Logic
    if getgenv().AutoCollect then
        for _, v in pairs(workspace:GetDescendants()) do
            if (v.Name == "Collect" or v.Name == "Collector") and v:IsA("BasePart") then
                firetouchinterest(root, v, 0)
                firetouchinterest(root, v, 1)
            end
        end
    end

    if getgenv().AutoBuy and not buyCooldown then
        buyCooldown = true
        task.spawn(function()
            for _, v in pairs(workspace:GetDescendants()) do
                if (v.Name == "Button" or v:FindFirstChild("Price")) and v:IsA("BasePart") and v.Transparency == 0 then
                    local isRobux = false
                    if v:FindFirstChild("Gamepass") or v:FindFirstChild("ProductID") or v:FindFirstChild("DevProduct") then
                        isRobux = true
                    else
                        for _, child in pairs(v:GetDescendants()) do
                            if child:IsA("TextLabel") and (child.Text:find("R%$") or child.Text:lower():find("robux")) then
                                isRobux = true break
                            end
                        end
                    end
                    if not isRobux then
                        firetouchinterest(root, v, 0)
                        firetouchinterest(root, v, 1)
                    end
                end
            end
            for i = 10, 1, -1 do Status.Text = "Status: Waiting ("..i.."s)" task.wait(1) end
            buyCooldown = false Status.Text = "Status: Ready"
        end)
    end

    -- Kill Aura Logic
    for _, ply in pairs(Players:GetPlayers()) do
        if ply ~= LocalPlayer and ply.Character and ply.Character:FindFirstChild("HumanoidRootPart") then
            local enemyRoot = ply.Character.HumanoidRootPart
            if (enemyRoot.Position - root.Position).Magnitude <= getgenv().AuraRange then
                local tool = char:FindFirstChildOfClass("Tool")
                if tool then
                    tool:Activate()
                    local h = tool:FindFirstChild("Handle") or tool:FindFirstChildOfClass("Part")
                    if h then 
                        local oldCFrame = h.CFrame
                        h.CFrame = enemyRoot.CFrame
                        for i = 1, 5 do
                            firetouchinterest(h, enemyRoot, 0)
                            firetouchinterest(h, enemyRoot, 1)
                        end
                        h.CFrame = oldCFrame
                    end
                end
            end
        end
    end
end)

-- Noclip Step Loop
RunService.Stepped:Connect(function()
    local char = LocalPlayer.Character
    if char and getgenv().Noclip then
        for _, v in pairs(char:GetDescendants()) do
            if v:IsA("BasePart") then v.CanCollide = false end
        end
    end
end)

-- // FADE MINIMIZE LOGIC
MinBtn.MouseButton1Click:Connect(function()
    minimized = not minimized
    local targetTransparency = minimized and 1 or 0
    local bgTargetTransparency = minimized and 1 or 0
    local tweenTime = 0.3
    
    TweenService:Create(Status, TweenInfo.new(tweenTime), {TextTransparency = targetTransparency}):Play()
    TweenService:Create(RangeDisplay, TweenInfo.new(tweenTime), {TextTransparency = targetTransparency}):Play()
    
    for _, b in pairs(buttons) do
        TweenService:Create(b, TweenInfo.new(tweenTime), {TextTransparency = targetTransparency, BackgroundTransparency = bgTargetTransparency}):Play()
    end
    
    MainFrame:TweenSize(minimized and UDim2.new(0, 250, 0, 45) or UDim2.new(0, 250, 0, 430), "Out", "Quad", tweenTime, true)
    MinBtn.Text = minimized and "+" or "-"
    
    if not minimized then
        Status.Visible = true; RangeDisplay.Visible = true
        for _, b in pairs(buttons) do b.Visible = true end
    else
        task.wait(tweenTime)
        if minimized then
            Status.Visible = false; RangeDisplay.Visible = false
            for _, b in pairs(buttons) do b.Visible = false end
        end
    end
end)
